<!DOCTYPE HTML>
<html>
<head><meta charset="utf-8"></head>
<body>
<style>
.tree span:hover {
  font-weight: bold;
}
.tree span {
  cursor: pointer;
}
</style>

<div id="tree"></div>

<script>
var tree = document.getElementById('tree');
var str = '';

treeArray = JSON.parse(localStorage.getItem('treeArray'));

//if (treeArray == undefined)
{ 
//alert();
treeArray = [
	'<ul class="tree">',
	'<li><span>Item 1</span>',
		'<ul>',
		'<li><span>Item 1.1</span>',
			'<ul>',
			'<li><span>Item 1.1.1</span></li>',
			'<li><span>Item 1.1.2</span>',
				'<ul>',
				'<li><span>Item A</span>',
					'<ul>',
					'<li><span><b>+</b></span><span>Item A.1</span></li>',
					'<li><span>Item A.2</span></li>',
					'<li><span>Item A.3</span></li>',
					'</ul>',
	 			'</li>',
				'</ul>',
				'</li>',
			'<li><span>Item 1.1.3</span></li>',
			'</ul>',
	 	'</li>',
		'</ul>',
	 '</li>',
	'</ul>',

	'<ul class="tree">',
	'<li><span>Item 2</span>',
		'<ul>','<li><span>Item 2.1</span>',
			'<ul>',
			'<li><span>Item 2.1.1</span></li>',
			'<li><span>Item 2.1.2</span></li>',
			'<li><span>Item 2.1.3</span></li>',
			'</ul>',
		'</ul>',
	 '</li>',
	'</ul>',

	'<ul class="tree">',
	'<li><span>Item 3</span>',
		'<ul>','<li><span>Item 3.1</span>',
			'<ul>',
			'<li><span>Item 3.1.1</span></li>',
			'<li><span>Item 3.1.2</span></li>',
			'<li><span>Item 3.1.3</span></li>',
			'</ul>',
		'</ul>',
	 '</li>',
	'</ul>',
];

localStorage.setItem('treeArray', JSON.stringify(treeArray));
}

for (var i=0, len = treeArray.length; i<len; i++) {
str +=treeArray[i];
}

tree.innerHTML +=str;

tree.onclick = function(evt) {
evt = evt || window.event;
var target = evt.target || evt.srcElement;

console.log(target);

if (target.tagName == 'b') {
var node = target;
console.log(node);

  var span = document.createElement('li');
  span.innerHTML = 'Test1';
  node.appendChild(span);

return;
}

if (target.tagName != 'SPAN') {
return;
}

var node = target.parentNode.getElementsByTagName('ul')[0];
console.log(node);

if (!node) return;

node.style.display = node.style.display ? '' : 'none';
}

// делаем узлы невыделяемыми
tree.onselectstart = tree.onmousedown = function() {
return false;
}

 



</script>


















